<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="alternate" href="/atom.xml" title="moefh.github.io" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="shortcut icon" href="/favicon.png">
  <title>moefh.github.io</title>
</head>
<body>
  <div class="logo"></div>
  <div class="header">
    <div class="header-nav-left">
      <a href="/">Home</a>
      <a href="/archives">Archives</a>
      <a href="/about">About</a>
    </div>
    <div class="header-nav-right">
      <a href="/atom.xml"><span class="rss-icon"></span></a>
    </div>
    <div class="header-title"><a href="/">moefh.github.io</a></div>
    <div class="header-subtitle">The Magic Smoke Has Left the Building</div>
  </div>


<div class="content">

<div class="content-left">

<div class="post">
  <div class="post-title"><a href="/2021/08/15/Pico-Homemade-MIDI-USB-Keyboard">Pico Homemade MIDI USB Keyboard</a></div>
  <div class="post-date">2021-08-15</div>
  <div class="post-content">
<p>
I made a very simple homemade MIDI keyboard USB device using the Raspberry Pi Pico:
</p>

<div class="image">
  <img width="640" height="480" src="/2021/08/15/Pico-Homemade-MIDI-USB-Keyboard/photo.jpg" alt="MIDI keyboard device built using a Pico attached to another Pico  acting as a hardware  debugger" title="MIDI keyboard device built using a Pico attached to another Pico  acting as a hardware  debugger">
  <div class="image-caption">MIDI keyboard device built using a Pico attached to another Pico  acting as a hardware  debugger</div>
</div>

<p>
The keyboard is just 12 buttons arranged as a vague semblance of a
piano keyboard (just one octave).  Each button closes the connection
to ground when pressed, and is connected to an input pin of the Pico
which is pulled up, so when the button is pressed the input goes low.
</p>

<p>
I used TinyUSB to make the Pico act as a MIDI USB device when
connected to a PC. The program is really simple: I just changed a MIDI
example included in the TinyUSB project, adapting it to send MIDI
notes when the buttons are pressed, with some very rudimentary
debouncing for the buttons.
</p>

<p>
This project gave me an excuse to learn how to program and debug a
Pico using another Pico as the hardware debugger, using picoprobe (I
had to do it because I usually <code>printf</code> debug using the USB serial,
but that obviously wouldn't work in this project).  To use picoprobe
you just have to flash the Pico that will be used as the debugger with
the picoprobe firmware (<code>picoprobe.uf2</code>) and make some connections
from its GPIO pins to the Pico being debugged (SWD pins and the UART
RX/TX).
</p>

<p>
Everything went really smoothly, so there's nothing much to say, other
than Picoprobe is a great way to upload programs to the Pico: there's
no need to reset with the Bootsel button pressed.  I might start using
it even when I'm not using the USB for anything else.  You can also
actually run GDB to debug the program live on the Pico, but I rarely
use GDB like that.
</p>

<p>
On the MIDI device side of things, it works really great on Windows. I
was even able to record a crappy song I played on the crappy keyboard
using <a href="https://www.midieditor.org/">MidiEditor</a>, even though there's
some noticeable input lag.
</p>

<p>
On Linux, I see no input lag when dumping the MIDI events with
<code>aseqdump</code> (an Alsa command line program), but I had no luck recording
input from the MIDI device using MIDI editors or other GUI programs.
Every GUI program I tried wasn't able to receive MIDI input -- most of
them just crash when trying to connect to Jack (which is installed and
running, but for some reason doesn't work), and the ones that can be
configured to use Alsa simply don't work when told to do so.  I have
no energy to try to make this work, so I'll have to use Windows if I
want to do more with this project.
</p>

<p>
In any case, this was a fun little project to learn how to make the
Pico into a USB device and use Picoprobe.

</p>
  </div>
  <div class="post-tags">
    <a href="/tags/usb">#usb</a>
    <a href="/tags/pico">#pico</a>
    <a href="/tags/midi">#midi</a>
    <a href="/tags/sound">#sound</a>
  </div>
</div>

<div class="footer">
    <div class="post-links">
      <div class="nav-link nav-link-left">
      </div>

      <div class="nav-link nav-link-separator"></div>
      
      <div class="nav-link nav-link-right">
        older &#x2192;<br>
        <a href="/2021/07/31/Porting-Loser-Corps-to-the-Raspberry-Pi-Pico-Part-2">Porting Loser Corps to the Raspberry Pi Pico - Part 2</a>
      </div>

    </div>

  <div class="copyright">Copyright (C) 2021 MoeFH</div>

</div>

</div>

<div class="content-right">
  <div class="tag-list">
    <div class="title">TAGS</div>
    <div class="tags">
      <div class="tag"><a href="/tags/arm">arm</a></div>
      <div class="tag"><a href="/tags/assembly">assembly</a></div>
      <div class="tag"><a href="/tags/esp-now">esp-now</a></div>
      <div class="tag"><a href="/tags/esp32">esp32</a></div>
      <div class="tag"><a href="/tags/esp32-loser">esp32-loser</a></div>
      <div class="tag"><a href="/tags/i2c">i2c</a></div>
      <div class="tag"><a href="/tags/joystick">joystick</a></div>
      <div class="tag"><a href="/tags/lm386">lm386</a></div>
      <div class="tag"><a href="/tags/loser-corps">loser-corps</a></div>
      <div class="tag"><a href="/tags/midi">midi</a></div>
      <div class="tag"><a href="/tags/mod">mod</a></div>
      <div class="tag"><a href="/tags/network">network</a></div>
      <div class="tag"><a href="/tags/nunchuk">nunchuk</a></div>
      <div class="tag"><a href="/tags/perfboard">perfboard</a></div>
      <div class="tag"><a href="/tags/pico">pico</a></div>
      <div class="tag"><a href="/tags/pico-loser">pico-loser</a></div>
      <div class="tag"><a href="/tags/raspberry-pi">raspberry-pi</a></div>
      <div class="tag"><a href="/tags/sound">sound</a></div>
      <div class="tag"><a href="/tags/stm32">stm32</a></div>
      <div class="tag"><a href="/tags/usb">usb</a></div>
      <div class="tag"><a href="/tags/vga">vga</a></div>
      <div class="tag"><a href="/tags/wii">wii</a></div>
      <div class="tag"><a href="/tags/wiimote">wiimote</a></div>
    </div>
  </div>

  <div class="month-list">
    <div class="title">ARCHIVES</div>
    <div class="months">
      <div class="month"><a href="/archives/2021/08">August 2021</a></div>
      <div class="month"><a href="/archives/2021/07">July 2021</a></div>
      <div class="month"><a href="/archives/2021/06">June 2021</a></div>
      <div class="month"><a href="/archives/2021/05">May 2021</a></div>
      <div class="month"><a href="/archives/2021/04">April 2021</a></div>
      <div class="month"><a href="/archives/2021/03">March 2021</a></div>
      <div class="month"><a href="/archives/2021/02">Ferbuary 2021</a></div>
    </div>
  </div>
</div>

</div>


</body>
</html>

