<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="alternate" href="/atom.xml" title="moefh.github.io" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="shortcut icon" href="/favicon.png">
  <title>moefh.github.io</title>
</head>
<body>
  <div class="logo"></div>
  <div class="header">
    <div class="header-nav-left">
      <a href="/">Home</a>
      <a href="/archives">Archives</a>
      <a href="/about">About</a>
    </div>
    <div class="header-nav-right">
      <a href="/atom.xml"><span class="rss-icon"></span></a>
    </div>
    <div class="header-title"><a href="/">moefh.github.io</a></div>
    <div class="header-subtitle">The Magic Smoke Has Left the Building</div>
  </div>


<div class="content">

<div class="content-left">

<div class="post">
  <div class="post-title"><a href="/2021/03/07/Porting-Loser-Corps-to-the-ESP32-Part-2">Porting Loser Corps to the ESP32 - Part 2</a></div>
  <div class="post-date">2021-03-07</div>
  <div class="post-content">
<p>
<i>More progress in porting Loser Corps to the ESP32 (see <a href="/tags/esp32-loser">all posts about the port</a>).</i>
</p>

<p>
Here's a demo video (click to open Youtube):
</p>

<div>
<a href="https://www.youtube.com/watch?v=BvJ3HLKo6p4"><div class="image">
  <img width="640" height="480" src="/2021/03/07/Porting-Loser-Corps-to-the-ESP32-Part-2/loser1.jpg" alt="Youtube video" title="Youtube video">
  <div class="image-caption">Youtube video</div>
</div></a>
</div>

<p>
(This video shows a slightly older version where collision detection
was done with the image rectangle, not the character's clipping
rectangle, which is why it looks a little wonky in a few places.)
</p>

<p>
As the video shows, you control a character in a map, walking and
jumping around.  I reworked some parts of the movement code, but it
feels a lot like the original, although I think the jump is not high
enough.  The collision detection is pretty much untouched, except for
what I absolutely had to do to make it run in the ESP32, which wasn't
much.
</p>

<p>
The joystick I'm using is a common Arduino joystick shield.  It's
pretty cheap and easy to use, but it requires one input pin of the
ESP32 for each button, and one analog input pin for each direction of
the stick -- it's really just a bunch of of buttons and
<a href="https://en.wikipedia.org/wiki/Potentiometer">potentiometers</a>
conveniently placed on a PCB:
</p>

<div class="image">
  <img width="640" height="480" src="/2021/03/07/Porting-Loser-Corps-to-the-ESP32-Part-2/loser3.jpg" alt="The Arduino joystick shield I'm using" title="The Arduino joystick shield I'm using">
  <div class="image-caption">The Arduino joystick shield I'm using</div>
</div>

<p>
I've connected all buttons pins, but the code only uses the C button
to jump and the X analog stick to move.
</p>

<p>
I've tried to use a Wiimote nunchuck and a Wiimote classic controller,
but I didn't have much success.  These controllers use an
<a href="https://en.wikipedia.org/wiki/I%C2%B2C">I2C</a> interface to talk to the
Wiimote, so it seems like they should be easy to use with the ESP32 --
and it actually works, but it's very unreliable.  The controller stops
replying for no apparent reason, a lot of times requiring an
unplug/re-plug to start working again.  I've tried it with no pullup
resistors, 4.7K pullups, 10K pullups, all for nothing.  The strangest
thing is that it works perfectly with an Arduino Uno (using the same
exact test code), even with no pullup resistors.  I say people saying
that the I2C part of the ESP32 Arduino library isn't that great, so
maybe that's the problem?
</p>

<p>
Another nice option would be to use the Wiimote itself, which uses
Bluetooth.  That's probably the next thing I'll work on in this
project.

</p>
  </div>
  <div class="post-tags">
    <a href="/tags/esp32">#esp32</a>
    <a href="/tags/esp32-loser">#esp32-loser</a>
    <a href="/tags/loser-corps">#loser-corps</a>
    <a href="/tags/vga">#vga</a>
    <a href="/tags/joystick">#joystick</a>
  </div>
</div>

<div class="footer">
    <div class="post-links">
      <div class="nav-link nav-link-left">
        &#x2190; newer<br>
        <a href="/2021/03/27/Porting-Loser-Corps-to-the-ESP32-Part-3">Porting Loser Corps to the ESP32 - Part 3</a>
      </div>

      <div class="nav-link nav-link-separator"></div>
      
      <div class="nav-link nav-link-right">
        older &#x2192;<br>
        <a href="/2021/02/28/Porting-Loser-Corps-to-the-ESP32">Porting Loser Corps to the ESP32</a>
      </div>

    </div>

  <div class="copyright">Copyright (C) 2021 MoeFH</div>

</div>

</div>

<div class="content-right">
  <div class="tag-list">
    <div class="title">TAGS</div>
    <div class="tags">
      <div class="tag"><a href="/tags/arm">arm</a></div>
      <div class="tag"><a href="/tags/assembly">assembly</a></div>
      <div class="tag"><a href="/tags/esp-now">esp-now</a></div>
      <div class="tag"><a href="/tags/esp32">esp32</a></div>
      <div class="tag"><a href="/tags/esp32-loser">esp32-loser</a></div>
      <div class="tag"><a href="/tags/i2c">i2c</a></div>
      <div class="tag"><a href="/tags/joystick">joystick</a></div>
      <div class="tag"><a href="/tags/loser-corps">loser-corps</a></div>
      <div class="tag"><a href="/tags/network">network</a></div>
      <div class="tag"><a href="/tags/nunchuk">nunchuk</a></div>
      <div class="tag"><a href="/tags/perfboard">perfboard</a></div>
      <div class="tag"><a href="/tags/pico">pico</a></div>
      <div class="tag"><a href="/tags/pico-loser">pico-loser</a></div>
      <div class="tag"><a href="/tags/raspberry-pi">raspberry-pi</a></div>
      <div class="tag"><a href="/tags/stm32">stm32</a></div>
      <div class="tag"><a href="/tags/vga">vga</a></div>
      <div class="tag"><a href="/tags/wii">wii</a></div>
      <div class="tag"><a href="/tags/wiimote">wiimote</a></div>
    </div>
  </div>

  <div class="month-list">
    <div class="title">ARCHIVES</div>
    <div class="months">
      <div class="month"><a href="/archives/2021/06">June 2021</a></div>
      <div class="month"><a href="/archives/2021/05">May 2021</a></div>
      <div class="month"><a href="/archives/2021/04">April 2021</a></div>
      <div class="month"><a href="/archives/2021/03">March 2021</a></div>
      <div class="month"><a href="/archives/2021/02">Ferbuary 2021</a></div>
    </div>
  </div>
</div>

</div>


</body>
</html>

